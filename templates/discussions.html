<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&family=Inter:ital,
      opsz,wght@0,14..32,100..900;1,14..32,100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Oswald
      :wght@200..700&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="icon"
      type="image/png"
      href="../static/sayIt-logos/logo-mono.png"
    />
    <link rel="stylesheet" href="../static/styles/main.css" />
    <title>sayIt | Discussions</title>
  </head>
  <body>
    <div class="whole-container">
      <div class="news-container container">
        <div class="categories">
          <!-- <h3 class="categories__title">Browse by Category</h3> -->
          <div class="categories__grid">
            {% for cat in categories %}
            <!--  {# looping through each category all of which have been injected globally #}-->
            <a
              href="{{ url_for('goto_category', category=cat) }}"
              class="category"
              >{{ cat.capitalize() }}</a
            >
            {% endfor %}
          </div>
        </div>
        <!-- Article Section -->
        {% if article %}
        <!--{# check if article exists #} -->
        <header class="news">
          <h1 class="news__title">{{ article.headline }}</h1>
          <p class="news__content">{{ article.description }}</p>
          <a
            href="{{ article.url }}"
            target="_blank"
            class="cta-button news-cta__btn"
            >Read More</a
          >
          <div class="news__meta">
            <div class="news__date">
              <span>üìÖ</span>
              <span>{{article['published at'] }}</span>
            </div>
            <div class="news__stats">
              <span>üëÅÔ∏è 12.4K views</span>
              <span>üí¨ 248 comments</span>
              <span>üî• Trending</span>
            </div>
          </div>
        </header>
        {% endif %} {% if article['status'] != 'fail' %}
        <section class="discussions">
          <h2 class="discussions__cta">Join the discussion</h2>

          <form
            action="{{ url_for('goto_category', category=category) }}"
            class="chat-form"
            method="post"
          >
            <label for="message" class="input-label"
              >What are your thoughts?</label
            >
            <textarea
              type="text"
              class="chat-input"
              name="comment"
              placeholder="Share your thoughts and join the conversation..."
              required
            ></textarea>
            <input class="submit-btn" type="submit" value="Post Comment" />
          </form>
          {% if all_remarks %}

          <div class="chat-messages">
            {% for remark in all_remarks %}
            <div class="message">
              <div class="message__header">
                <span class="message__author">{{remark.user.username}}</span>

                <span class="message__time"
                  >{{ remark.created_at | timeago }}</span
                >
              </div>
              <div class="message__content">{{ remark.content }}</div>
            </div>
            {% endfor %} {% else %}

            <div class="empty-state" hidden>
              Be the first to share your thoughts on this story!
            </div>
          </div>
          {% endif %}
        </section>
        {% endif %}
      </div>
    </div>
  </body>
  <script>
    const categories = document.querySelectorAll(".category");
    for (const [i, category] of categories.entries()) {
      category[i].classList.add("active");
    }
    // const categories = document.querySelectorAll(".category");
    // for (const [i, category] of categories.entries()) {
    //   category.addEventListener("click", (e) => {
    //     e.preventDefault();
    //     // Remove 'active' class from all categories and add it to the clicked one
    //     categories.forEach((cat) => cat.classList.remove("active"));
    //     category.classList.add("active");
    //   });
    // }
  </script>
</html>
